<main class="section">
    <div ng-controller="ThreadsCtrl" class="container row">
        <!--Title-->
        <h1 class="center">PowerUp Threads</h1>

        <!--Threads-->
        <div class="row">

            <h5 ng-if="threads.length == 0" class="center">
                No threads to show.

                <!--TODO create thread-->
                <!--<c:if test="${isLoggedIn}">-->
                    <!--Why not <a href="<c:url value="/create-thread" />">create one?</a>-->
                <!--</c:if>-->
            </h5>
            <div ng-if="threads.length > 0" class="row">
                <div class="col s12">
                    <a class="btn waves-effect waves-light {{(order == 'hot')? '' : 'inactive'}}"
                       ng-href="#threads?order=hot">Hottest</a>
                    <a class="btn waves-effect waves-light {{(order == 'newest')? '' : 'inactive'}}"
                       ng-href="#threads?order=newest">Newest</a>
                    <a class="btn waves-effect waves-light {{(order == 'best')? '' : 'inactive'}}"
                       ng-href="#threads?order=best">Highest Scoring</a>
                </div>
            </div>
            <ul ng-if="threads.length > 0" class="collection">
                <li ng-repeat="thread in threads" class="collection-item avatar">

                    <img ng-src="{{apiLocation}}/users/{{thread.creator.id}}/picture"
                    alt="{{thread.creator.username}}" class="circle">
                    <a class="title truncate" ng-href="#thread?id={{thread.id}}">{{thread.title}}</a>

                    <!--<p>Submitted <fmt:formatDate value="${thread.createdAt.time}" type="both" /> by <c:out value="${thread.creator.username}" /></p>-->
                    <p>Submitted {{thread.createdAt}}<!--createdAt.Time--> by {{thread.creator.username}}</p>
                    <br>
                    <p class="truncate">
                        {{thread.initialComment}}
                    </p>

                    <!--Un/like section-->
                    <span href="#!" class="secondary-content"><b>{{thread.likeCount}}</b>
                        <!--&nbsp;&nbsp; wwwwaaaaattttt TODO-->
                                <i ng-if="!isLoggedIn()" class="material-icons black-text">thumb_up</i>
                                <a ng-if="isLoggedIn() && isLikedByCurrentUser(thread)" href="#!"
                                   class="unlike-thread" data-thread-id="{{thread.id}}"><i
                                        class="material-icons green-text">thumb_up</i></a>
                                <a ng-if="isLoggedIn() &&  !isLikedByCurrentUser(thread)" href="#!"
                                   class="like-thread" data-thread-id="${thread.id}"><i
                                        class="material-icons black-text">thumb_up</i></a>
                            </span>
                    <!--End un/like section-->
                </li>
            </ul>

        </div>
        <!--FAB-->
        <div ng-if="isLoggedIn()" class="fixed-action-btn" style="bottom:10%;">
            <!--href="<c:url value="/create-thread" />"-->
            <a id="create-thread-fab" class="btn-floating btn-large waves-effect waves-light red">
                <!--TODO do create threads-->
                <i class="large material-icons">mode_edit</i>
            </a>
        </div>
        <!--END FAB-->
    </div>

</main>

<!--<script type="text/javascript">-->
    <!--$(function() {-->
        <!--$(".like-thread").on("click", function(event) {-->
            <!--var threadId = $(this).data("thread-id");-->
            <!--//Create an inline form and submit it to redirect with POST-->
            <!--$("<form action='<c:url value="/like-thread" />' method='POST'> \-->
                <!--<input type='hidden' name='threadId' value='" + threadId + "' /> \-->
                <!--<input type='hidden' name='returnUrl' value='/threads#" + threadId + "' /> \-->
               <!--</form>").submit();-->
        <!--});-->

        <!--$(".unlike-thread").on("click", function(event) {-->
            <!--var threadId = $(this).data("thread-id");-->
            <!--//Create an inline form and submit it to redirect with POST-->
            <!--$("<form action='<c:url value="/unlike-thread" />' method='POST'> \-->
                <!--<input type='hidden' name='threadId' value='" + threadId + "' /> \-->
                <!--<input type='hidden' name='returnUrl' value='/threads#" + threadId + "' /> \-->
               <!--</form>").submit();-->
        <!--});-->
    <!--});-->
<!--</script>-->